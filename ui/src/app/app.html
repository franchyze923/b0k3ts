<mat-sidenav-container class="app-shell">
  @if (authenticated()) {
    <mat-sidenav class="app-sidenav" mode="side" opened>
      <div class="sidenav-header">
        <div class="brand">B0K3TS</div>
        <div class="brand-sub">Bucket tools</div>
      </div>

      <mat-nav-list>
        <a mat-list-item routerLink="/object-manager" routerLinkActive="active">
          <mat-icon matListItemIcon>folder</mat-icon>
          <span matListItemTitle>Object Manager</span>
        </a>

        <a mat-list-item routerLink="/settings" routerLinkActive="active">
          <mat-icon matListItemIcon>settings</mat-icon>
          <span matListItemTitle>Settings</span>
        </a>

        @if (isSettingsSectionOpen()) {
          <div class="sidenav-subsection">
            <a mat-list-item routerLink="/settings/buckets" routerLinkActive="active">
              <mat-icon matListItemIcon>storage</mat-icon>
              <span matListItemTitle>Bucket Connections</span>
            </a>

            @if (isAdmin()) {
              <a mat-list-item routerLink="/settings/oidc" routerLinkActive="active">
                <mat-icon matListItemIcon>vpn_key</mat-icon>
                <span matListItemTitle>OIDC</span>
              </a>

              <a mat-list-item routerLink="/settings/kubernetes" routerLinkActive="active">
                <mat-icon matListItemIcon>dns</mat-icon>
                <span matListItemTitle>Kubernetes</span>
              </a>

              <a mat-list-item routerLink="/settings/users" routerLinkActive="active">
                <mat-icon matListItemIcon>manage_accounts</mat-icon>
                <span matListItemTitle>Users</span>
              </a>
            }
          </div>
        }

        @if (isAdmin()) {
          <a mat-list-item routerLink="/plugins" routerLinkActive="active">
            <mat-icon matListItemIcon>extension</mat-icon>
            <span matListItemTitle>Plugins</span>
          </a>

          @if (isPluginsSectionOpen()) {
            <div class="sidenav-subsection">
              <a mat-list-item routerLink="/plugins/ceph" routerLinkActive="active">
                <mat-icon matListItemIcon>cloud</mat-icon>
                <span matListItemTitle>Ceph</span>
              </a>
            </div>
          }
        }
      </mat-nav-list>
    </mat-sidenav>
  }

  <mat-sidenav-content>
    <mat-toolbar color="primary" class="topbar">
      <span class="page-title">{{ globalService.currentTitle | async }}</span>

      <span class="spacer"></span>

      <button mat-button type="button" [matMenuTriggerFor]="userMenu">
        <mat-icon aria-hidden="true">more_vert</mat-icon>
        <span>Menu</span>
      </button>

      <mat-menu #userMenu="matMenu">
        <button mat-menu-item type="button" disabled>
          <mat-icon aria-hidden="true">person</mat-icon>
          <span>{{ globalService.currentTitle | async }}</span>
        </button>

        <button mat-menu-item type="button" (click)="toggleTheme()">
          <mat-icon aria-hidden="true">brightness_6</mat-icon>
          <span>{{ theme.theme() === 'dark' ? 'Light mode' : 'Dark mode' }}</span>
        </button>

        @if (authenticated()) {
          <button mat-menu-item type="button" (click)="logout()">
            <mat-icon aria-hidden="true">logout</mat-icon>
            <span>Logout</span>
          </button>
        }
      </mat-menu>
    </mat-toolbar>

    <main class="content">
      <router-outlet />
    </main>
  </mat-sidenav-content>
</mat-sidenav-container>
